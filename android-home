#!/usr/bin/env bash
# Android Home - CLI tool and installer
# Install with: ln -sf ~/.android-home/android-home /data/data/com.termux/files/usr/bin/android-home

INSTALL_DIR="$HOME/.android-home"
SCRIPTS_DIR="$INSTALL_DIR/scripts"

case "$1" in
    setup)
        if [[ -z "$2" ]]; then
            echo "Usage: android-home setup <service>"
            echo "Services: ssh, filebrowser, cloudflare-tunnel, all"
            exit 1
        fi
        if [[ "$2" == "all" ]]; then
            bash "$SCRIPTS_DIR/ssh/setup.sh"
            bash "$SCRIPTS_DIR/filebrowser/setup.sh"
            bash "$SCRIPTS_DIR/cloudflare-tunnel/setup.sh"
        else
            bash "$SCRIPTS_DIR/${2}/setup.sh"
        fi
        ;;
    start)
        if [[ -z "$2" ]]; then
            echo "Usage: android-home start <service>"
            echo "Services: ssh, filebrowser, cloudflare-tunnel"
            exit 1
        fi
        bash "$SCRIPTS_DIR/${2}/start.sh" "${@:3}"
        ;;
    status)
        bash "$SCRIPTS_DIR/lib/status.sh"
        ;;
    update)
        bash "$SCRIPTS_DIR/update.sh"
        ;;
    help|--help|-h|"")
        cat << HELP
Usage: android-home <command> [options]

Commands:
  setup <service>    Setup a service (ssh, filebrowser, cloudflare-tunnel, all)
  start <service>    Start a service (ssh, filebrowser, cloudflare-tunnel)
  status             Show service status
  update             Update to latest version
  help               Show this help message

Examples:
  android-home setup ssh
  android-home start filebrowser
  android-home update

HELP
        ;;
    *)
        echo "Unknown command: $1"
        echo "Run 'android-home help' for usage"
        exit 1
        ;;
esac
